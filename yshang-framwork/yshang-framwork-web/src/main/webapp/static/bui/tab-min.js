define("bui/tab",["bui/common","jquery","bui/menu"],function(c,b,d){var e=c("bui/common"),a=e.namespace("Tab");e.mix(a,{Tab:c("bui/tab/tab"),TabItem:c("bui/tab/tabitem"),NavTabItem:c("bui/tab/navtabitem"),NavTab:c("bui/tab/navtab"),TabPanel:c("bui/tab/tabpanel"),TabPanelItem:c("bui/tab/tabpanelitem")});d.exports=a});define("bui/tab/tab",["bui/common","jquery"],function(c,a,d){var g=c("bui/common"),b=g.Component,f=b.UIBase;var e=b.Controller.extend([f.ChildList],{},{ATTRS:{elTagName:{view:true,value:"ul"},defaultChildClass:{value:"tab-item"}}},{xclass:"tab"});d.exports=e});define("bui/tab/tabitem",["bui/common","jquery"],function(c,a,d){var h=c("bui/common"),b=h.Component,g=b.UIBase;var e=b.View.extend([g.ListItemView],{},{xclass:"tab-item-view"});var f=b.Controller.extend([g.ListItem],{},{ATTRS:{elTagName:{view:true,value:"li"},xview:{value:e},tpl:{view:true,value:'<span class="bui-tab-item-text">{text}</span>'}}},{xclass:"tab-item"});f.View=e;d.exports=f});define("bui/tab/navtabitem",["jquery","bui/common"],function(f,h,d){var i=f("jquery"),k=f("bui/common"),l=k.Component,m="tab-item-title",c="tab-item-close",e="tab-item-inner",a="tab-nav-actived",j="tab-content";var g=l.View.extend({renderUI:function(){var n=this,o=n.get("tabContentContainer"),q=n.get("tabContentTpl");if(o){var p=i(q).appendTo(o);n.set("tabContentEl",p)}},_uiSetHref:function(n){this._setHref(n)},_setHref:function(o){var n=this,p=n.get("tabContentEl");o=o||n.get("href");if(p){i("iframe",p).attr("src",o)}},resetHref:function(){this._setHref()},_uiSetTitle:function(o){var n=this,p=n.get("el");i("."+m,p).html(o)},_uiSetActived:function(o){var n=this,p=n.get("el");n.setTabContentVisible(o);if(o){p.addClass(a)}else{p.removeClass(a)}},destructor:function(){var n=this,o=n.get("tabContentEl");if(o){o.remove()}},setTabContentVisible:function(o){var n=this,p=n.get("tabContentEl");if(p){if(o){p.show()}else{p.hide()}}}},{ATTRS:{tabContentContainer:{},tabContentEl:{},title:{},href:{}}});var b=l.Controller.extend({createDom:function(){var n=this,o=n.get("parent");if(o){n.set("tabContentContainer",o.getTabContentContainer())}},bindUI:function(){var n=this,p=n.get("el"),o=n.get("events");p.on("click",function(r){var q=i(r.target);if(q.hasClass(c)){if(n.fire("closing")!==false){n.close()}}})},handleDblClick:function(o){var n=this;if(n.get("closeable")&&n.fire("closing")!==false){n.close()}n.fire("dblclick",{domTarget:o.target,domEvent:o})},handleContextMenu:function(n){n.preventDefault();this.fire("showmenu",{position:{x:n.pageX,y:n.pageY}})},setTitle:function(n){this.set("title",n)},close:function(){this.fire("closed")},reload:function(){this.get("view").resetHref()},show:function(){var n=this;n.get("el").show(500,function(){n.set("visible",true)})},hide:function(o){var n=this;this.get("el").hide(500,function(){n.set("visible",false);o&&o()})},_uiSetActived:function(o){var n=this,p=n.get("parent");if(p&&o){p._setItemActived(n)}},_uiSetCloseable:function(o){var n=this,p=n.get("el"),q=p.find("."+c);if(o){q.show()}else{q.hide()}}},{ATTRS:{elTagName:{value:"li"},actived:{view:true,value:false},closeable:{value:true},allowTextSelection:{view:false,value:false},events:{value:{"click":true,"closing":true,"closed":true,"showmenu":true,"afterVisibleChange":true}},tabContentContainer:{view:true},tabContentTpl:{view:true,value:'<div class="'+j+'" style="display:none;"><iframe src="" width="100%" height="100%" frameborder="0"></iframe></div>'},href:{view:true,value:""},visible:{view:true,value:true},title:{view:true,value:""},tpl:{view:true,value:'<s class="l"></s><div class="'+e+'">{icon}<span class="'+m+'"></span><s class="'+c+'"></s></div><s class="r"></s>'},xview:{value:g}}},{xclass:"nav-tab-item",priority:0});b.View=g;d.exports=b});define("bui/tab/navtab",["bui/common","jquery","bui/menu"],function(b,e,a){var j=b("bui/common"),g=b("bui/menu"),m=j.Component,h="tab-nav-list",d="arrow-left",c="arrow-right",l=j.prefix+"tab-force",f="m_close",i=140;var n=m.View.extend({renderUI:function(){var o=this,p=o.get("el"),q=null;q=p.find("."+h);o.setInternal("listEl",q)},getContentElement:function(){return this.get("listEl")},getTabContentContainer:function(){return this.get("el").find(".tab-content-container")},_uiSetHeight:function(q){var o=this,r=o.get("el"),p=r.find(".tab-nav-bar"),s=o.getTabContentContainer();if(q){s.height(q-p.height())}r.height(q)},_uiSetForceFit:function(p){var o=this,q=o.get("el");if(p){q.addClass(l)}else{q.removeClass(l)}}},{ATTRS:{forceFit:{}}},{xclass:"nav-tab-view",priority:0});var k=m.Controller.extend({addTab:function(p,s){var o=this,u=p.id||j.guid("tab-item"),q=o.get("forceFit"),r=o.getItemById(u);if(r){var t=false;if(p.href&&r.get("href")!=p.href){r.set("href",p.href);t=true}o._setItemActived(r);if(s&&!t){r.reload()}}else{p=j.mix({id:u,visible:false,actived:true,xclass:"nav-tab-item"},p);r=o.addChild(p);if(q){o.forceFit()}r.show();o._resetItemList()}return r},getTabContentContainer:function(){return this.get("view").getTabContentContainer()},bindUI:function(){var o=this,p=o.get("forceFit");if(!p){o._bindScrollEvent();o.on("afterVisibleChange",function(r){var q=r.target;if(q.get("actived")){o._scrollToItem(q)}})}o.on("click",function(r){var q=r.target;if(q!=o){o._setItemActived(q);o.fire("itemclick",{item:q})}});o.on("closed",function(r){var q=r.target;o._closeItem(q)});o.on("showmenu",function(q){o._showMenu(q.target,q.position)})},_bindScrollEvent:function(){var o=this,p=o.get("el");p.find(".arrow-left").on("click",function(){if(p.hasClass(d+"-active")){o._scrollLeft()}});p.find(".arrow-right").on("click",function(){if(p.hasClass(c+"-active")){o._scrllRight()}})},_showMenu:function(q,p){var o=this,t=o._getMenu(),s=q.get("closeable"),r;o.set("showMenuItem",q);t.set("xy",[p.x,p.y]);t.show();r=t.getItem(f);if(r){r.set("disabled",!s)}},setActived:function(q){var o=this,p=o.getItemById(q);o._setItemActived(p)},getActivedItem:function(){var p=this,q=p.get("children"),o=null;j.each(q,function(r){if(r.get("actived")){o=r;return false}});return o},getItemById:function(r){var p=this,q=p.get("children"),o=null;j.each(q,function(s){if(s.get("id")===r){o=s;return false}});return o},_getMenu:function(){var o=this;return o.get("menu")||o._initMenu()},_initMenu:function(){var o=this,p=new g.ContextMenu({children:[{xclass:"context-menu-item",iconCls:"icon icon-refresh",text:"刷新",listeners:{"click":function(){var q=o.get("showMenuItem");if(q){q.reload()}}}},{id:f,xclass:"context-menu-item",iconCls:"icon icon-remove",text:"关闭",listeners:{"click":function(){var q=o.get("showMenuItem");if(q){q.close()}}}},{xclass:"context-menu-item",iconCls:"icon icon-remove-sign",text:"关闭其他",listeners:{"click":function(){var q=o.get("showMenuItem");if(q){o.closeOther(q)}}}},{xclass:"context-menu-item",iconCls:"icon icon-remove-sign",text:"关闭所有",listeners:{"click":function(){o.closeAll()}}}]});o.set("menu",p);return p},_closeItem:function(s){var q=this,r=q._getIndex(s),p=q.getActivedItem(),t=q.get("preItem")||q._getItemByIndex(r-1),o=q._getItemByIndex(r+1);s.hide(function(){q.removeChild(s,true);q._resetItemList();if(p===s){if(t){q._setItemActived(t)}else{q._setItemActived(o)}}else{q._scrollToItem(p)}q.forceFit()})},closeAll:function(){var o=this,p=o.get("children");j.each(p,function(q){if(q.get("closeable")){q.close()}})},closeOther:function(q){var o=this,p=o.get("children");j.each(p,function(r){if(q!==r){r.close()}})},_getItemByIndex:function(p){var o=this,q=o.get("children");return q[p]},_getIndex:function(q){var o=this,p=o.get("children");return j.Array.indexOf(q,p)},_resetItemList:function(){if(this.get("forceFit")){return}var o=this,p=o.getContentElement();p.width(o._getTotalWidth())},_getTotalWidth:function(){var o=this,p=o.get("children");return p.length*o.get("itemWidth")+p.length*6},_getForceItemWidth:function(){var p=this,r=p.getContentElement().width(),q=p.get("children"),o=p._getTotalWidth(),s=p.get(s);if(o>r){s=r/q.length}return s},forceFit:function(){var o=this;o._forceItemWidth(o._getForceItemWidth())},_forceItemWidth:function(q){q=q||this.get("itemWidth");var o=this,p=o.get("children");j.each(p,function(r){r.set("width",q)})},_scrollToItem:function(u){if(this.get("forceFit")){return}var p=this,r=p.getContentElement(),o=r.position(),t=p._getDistanceToEnd(u,r,o),s=p._getDistanceToBegin(u,o);if(r.width()<r.parent().width()){p._scrollTo(r,0)}else{if(s<0){p._scrollTo(r,o.left-(s))}else{if(t>0){p._scrollTo(r,o.left+(t)*-1)}else{if(o.left<0){var q=p._getLastDistance(r,o),v=0;if(q<0){v=o.left-q;v=v<0?v:0;p._scrollTo(r,v)}}}}}},_getDistanceToBegin:function(q,p){var o=q.get("el").position();return o.left+p.left},_getDistanceToEnd:function(t,q,p){var o=this,q=q||o.getContentElement(),s=q.parent().width(),p=p||q.position(),u=o._getDistanceToBegin(t,p),r=u+o.get("itemWidth")-s;return r},_getLastDistance:function(q,p){var o=this,r=o.get("children"),s=r[r.length-1];if(s){return o._getDistanceToEnd(s,q,p)}return 0},_scrollTo:function(p,q,r){var o=this;p.animate({left:q},500,function(){o._setArrowStatus(p)})},_scrollLeft:function(){var p=this,q=p.getContentElement(),o=q.position(),r=p._getLastDistance(q,o),s;if(r>0){s=r>p.get("itemWidth")?p.get("itemWidth"):r;p._scrollTo(q,o.left-s)}},_scrllRight:function(){var p=this,q=p.getContentElement(),o=q.position(),r;if(o.left<0){r=o.left+p.get("itemWidth");r=r<0?r:0;p._scrollTo(q,r)}},_setArrowStatus:function(r,q){r=r||this.getContentElement();var p=this,t=p.get("el"),o=q||r.position(),s=p._getLastDistance(r,q);if(o.left<0){t.addClass(c+"-active")}else{t.removeClass(c+"-active")}if(s>0){t.addClass(d+"-active")}else{t.removeClass(d+"-active")}},_setItemActived:function(q){var o=this,p=o.getActivedItem();if(q===p){return}if(p){p.set("actived",false)}o.set("preItem",p);if(q){if(!q.get("actived")){q.set("actived",true)}if(q.get("visible")){o._scrollToItem(q)}o.fire("activeChange",{item:q});o.fire("activedchange",{item:q})}}},{ATTRS:{defaultChildClass:{value:"nav-tab-item"},menu:{},forceFit:{view:true,value:false},itemWidth:{value:i},tpl:{view:true,value:'<div class="tab-nav-bar">'+'<s class="tab-nav-arrow arrow-left"></s><div class="tab-nav-wrapper"><div class="tab-nav-inner"><ul class="'+h+'"></ul></div></div><s class="tab-nav-arrow arrow-right"></s>'+"</div>"+'<div class="tab-content-container"></div>'},xview:{value:n},events:{value:{"itemclick":false,activedchange:false}}}},{xclass:"nav-tab",priority:0});a.exports=k});define("bui/tab/tabpanel",["bui/common","jquery"],function(d,c,e){var f=d("bui/common"),a=d("bui/tab/tab"),b=d("bui/tab/panels");var g=a.extend([b],{bindUI:function(){var h=this;h.on("beforeclosed",function(j){var i=j.target;h._beforeClosedItem(i)})},_beforeClosedItem:function(l){if(!l.get("selected")){return}var i=this,j=i.indexOfItem(l),k=i.getItemCount(),m,h;if(j!==k-1){h=i.getItemAt(j+1);i.setSelected(h)}else{if(j!==0){m=i.getItemAt(j-1);i.setSelected(m)}}}},{ATTRS:{elTagName:{value:"div"},childContainer:{value:"ul"},tpl:{value:'<div class="tab-panel-inner"><ul></ul><div class="tab-panels"></div></div>'},panelTpl:{value:"<div></div>"},panelContainer:{value:".tab-panels"},defaultChildClass:{value:"tab-panel-item"}}},{xclass:"tab-panel"});e.exports=g});define("bui/tab/panels",["jquery"],function(c,b,d){var e=c("jquery");var a=function(){};a.ATTRS={panelTpl:{},panelContainer:{},panelCls:{}};BUI.augment(a,{__renderUI:function(){var f=this,h=f.get("children"),i=f._initPanelContainer(),j=f.get("panelCls"),g=j?i.find("."+g):i.children();BUI.each(h,function(m,l){var k=g[l];f._initPanelItem(m,k)})},__bindUI:function(){var f=this;f.on("beforeAddChild",function(h){var g=h.child;f._initPanelItem(g)})},_initPanelContainer:function(){var f=this,g=f.get("panelContainer");if(g&&BUI.isString(g)){if(g.indexOf("#")==0){g=e(g)}else{g=f.get("el").find(g)}f.setInternal("panelContainer",g)}return g},_initPanelItem:function(h,g){var f=this;if(h.set){if(!h.get("panel")){g=g||f._getPanel(h.get("userConfig"));h.set("panel",g)}}else{if(!h.panel){g=g||f._getPanel(h);h.panel=g}}},_getPanel:function(h){var f=this,g=f.get("panelContainer"),i=BUI.substitute(f.get("panelTpl"),h);return e(i).appendTo(g)}});d.exports=a});define("bui/tab/tabpanelitem",["bui/common","jquery"],function(c,d,a){var e=c("bui/common"),b=c("bui/tab/tabitem"),g=c("bui/tab/panelitem"),h="bui-tab-item-text",i=e.Component;var f=b.View.extend([i.UIBase.Close.View],{_uiSetTitle:function(m){var k=this,n=k.get("el"),l=n.find("."+h);l.text(m)}},{xclass:"tab-panel-item-view"});var j=b.extend([g,i.UIBase.Close],{},{ATTRS:{closeAction:{value:"remove"},title:{view:true,sync:false},tpl:{value:'<span class="'+h+'">{text}{title}</span>'},closeable:{value:false},events:{value:{beforeclosed:true}},xview:{value:f}}},{xclass:"tab-panel-item"});j.View=f;a.exports=j});define("bui/tab/panelitem",["jquery"],function(c,b,d){var e=c("jquery");var a=function(){};a.ATTRS={panel:{},panelContent:{},panelVisibleStatus:{value:"selected"},defaultLoaderCfg:{valueFn:function(){var f=this,g=f._getVisibleEvent();return{property:"panelContent",autoLoad:false,lazyLoad:{event:g},loadMask:{el:f.get("panel")}}}},panelDestroyable:{value:true}};BUI.augment(a,{__renderUI:function(){this._resetPanelVisible()},__bindUI:function(){var f=this,g=f._getVisibleEvent();f.on(g,function(h){f._setPanelVisible(h.newVal)})},_resetPanelVisible:function(){var f=this,g=f.get("panelVisibleStatus"),h=f.get(g);f._setPanelVisible(h)},_getVisibleEvent:function(){var f=this,g=f.get("panelVisibleStatus");return"after"+BUI.ucfirst(g)+"Change"},_setPanelVisible:function(h){var f=this,g=f.get("panel"),i=h?"show":"hide";if(g){e(g)[i]()}},__destructor:function(){var f=this,g=f.get("panel");if(g&&f.get("panelDestroyable")){e(g).remove()}},_setPanelContent:function(f,g){var h=e(f);e(f).html(g)},_uiSetPanelContent:function(h){var f=this,g=f.get("panel");f._setPanelContent(g,h)},_uiSetPanel:function(g){var f=this,h=f.get("panelContent");if(h){f._setPanelContent(g,h)}f._resetPanelVisible()}});d.exports=a});